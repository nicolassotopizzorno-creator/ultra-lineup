:root{
  --bg:#0f0f14;
  --panel2:#1c1c24;
  --border:#242432;
  --border2:#2a2a35;
  --text:#fff;
  --muted:#cfcfe6;
  --accent:#7b3cff;
  --now:#ff3b30;

  --grid: rgba(255,255,255,0.06);

  --lineHour: rgba(255,255,255,0.38);
  --line30:  rgba(255,255,255,0.24);
  --line15:  rgba(255,255,255,0.12);

  --col-stage: 220px;
  --row-h: 92px;
  --header-h: 46px;   /* mitad de --row-h */
}

*{ box-sizing:border-box; }

body{
  font-family: Arial, sans-serif;
  background: radial-gradient(1200px 600px at 50% 0%, rgba(255,255,255,0.05), transparent), var(--bg);
  color: var(--text);
  margin: 20px;
  overflow-x: hidden;  /* evita scroll horizontal global */
}

/* =====================
   TOPBAR
   ===================== */
.topbar{
  display:grid;
  grid-template-columns: 1fr auto 1fr;
  align-items:center;
  gap:14px;
  margin-bottom:12px;
}

.topbar-center{
  display:flex;
  justify-content:center;
  align-items:center;
}

.logo{
  height:58px;
  width:auto;
  object-fit:contain;
  filter: drop-shadow(0 2px 8px rgba(0,0,0,.35));
}

.topbar-right{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  gap:14px;
}

.day-switch{
  background: var(--panel2);
  border:1px solid var(--border2);
  padding:6px;
  border-radius:12px;
  display:flex;
  gap:6px;
}

.day-btn{
  border:none;
  background:transparent;
  color: var(--muted);
  padding:10px 14px;
  border-radius:10px;
  font-weight:800;
  cursor:pointer;
  transition: all 0.2s;
}

.day-btn:hover{ background: rgba(255,255,255,0.05); }

.day-btn.active{
  background: var(--accent);
  color:white;
}

.day-meta{
  font-weight:800;
  opacity:.85;
  min-width:52px;
  text-align:right;
}

/* =====================
   LAYOUT PRINCIPAL
   El truco: columna fija FUERA del scroll
   ===================== */
#timetableOuter{
  display:flex;
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;           /* recorta las esquinas redondeadas */
  background: rgba(255,255,255,0.02);
}

/* Columna izquierda: SIEMPRE VISIBLE, nunca scrollea */
#stageColumn{
  flex: 0 0 var(--col-stage);
  min-width: var(--col-stage);
  display:flex;
  flex-direction:column;
  border-right: 2px solid var(--border);
  background: var(--bg);
  z-index: 2;                /* por encima del área scrolleable */
  position: relative;        /* para que z-index funcione */
}

.stage-label{
  height: var(--row-h);
  display:flex;
  align-items:center;
  padding-left:18px;
  font-weight:900;
  font-size:18px;
  border-bottom: 1px solid var(--grid);
  background: var(--bg);
  flex-shrink:0;
}

.stage-label.corner{
  height: var(--header-h);   /* misma altura que la fila de horas */
  background: var(--bg);
  border-bottom: 1px solid var(--grid);
}

/* Área derecha: scrolleable */
#scrollArea{
  flex: 1 1 auto;
  overflow-x:auto;
  overflow-y:hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  position: relative;
}

/* =====================
   TIMETABLE GRID (solo horarios + celdas)
   ===================== */
#timetable{
  display:grid;
  grid-auto-rows: var(--row-h);
  /* Primera fila (header de horas) más baja */
  grid-template-rows: var(--header-h);
  position: relative;
}

.cell{
  border: 1px solid var(--grid);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:10px;
  position:relative;
}

/* Header de horas */
.header{
  background: rgba(255,255,255,0.04);
  font-weight:900;
  font-size:14px;
  justify-content:flex-start;
  align-items:flex-end;
  padding-bottom:5px;
  padding-left:8px;
  text-align:left;
  overflow:visible;
  height: var(--header-h);
}

.header.is-halfhour{
  color: transparent;
  text-shadow: none;
}

/* Ticks — ahora 1 celda = 1 hora */
.header .tick-hour,
.header .tick-30,
.header .tick-15{
  position:absolute;
  bottom:0;
  pointer-events:none;
}

/* Línea de la hora — 100% de alto, desde arriba */
.header .tick-hour{
  top:0;
  left:0;
  width:2px;
  background: var(--lineHour);
}

/* Línea de los 30 min — 75% de alto, desde abajo */
.header .tick-30{
  top:25%;
  left:50%;
  width:2px;
  transform: translateX(-1px);
  background: var(--line30);
}

/* Línea de los 15 min — 56.25% de alto (75% del 75%), desde abajo */
.header .tick-15.tick-15-a{
  top:43.75%;
  left:25%;
  width:1px;
  transform: translateX(-0.5px);
  background: var(--line15);
}

.header .tick-15.tick-15-b{
  top:43.75%;
  left:75%;
  width:1px;
  transform: translateX(-0.5px);
  background: var(--line15);
}

/* =====================
   LÍNEA "AHORA"
   ===================== */
#timeLine{
  position:absolute;
  top:0; bottom:0;
  width:2px;
  background: var(--now);
  z-index:50;
  pointer-events:none;
  box-shadow: 0 0 12px rgba(255,59,48,0.35);
}

/* Pill de hora actual — centrado en la cabecera, sin fondo grande */
#timeLineLabel{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  background: var(--now);
  color:white;
  font-size:10px;
  font-weight:900;
  padding:2px 6px;
  border-radius:6px;
  white-space:nowrap;
  box-shadow:0 1px 6px rgba(0,0,0,.6);
  pointer-events:none;
  z-index:55;
  display:flex;
  align-items:center;
}

/* =====================
   OVERLAYS DE DJs
   ===================== */
.stage-row{
  position:absolute;
  pointer-events:none;
  z-index:10;
}

.dj-block{
  position:absolute;
  top: 14px;
  height: calc(100% - 28px);
  border-radius: 14px;
  padding: 10px 12px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:6px;
  color:white;
  font-weight:900;
  z-index:20;
  overflow:hidden;         /* ← recorta dim-overlay e itinerary-seg en las esquinas */
  cursor: pointer;
  transition: transform 0.15s, box-shadow 0.15s;
  border: 1px solid rgba(255,255,255,0.10);
  outline: 1px solid rgba(0,0,0,0.18);
  outline-offset: -1px;
}

.dj-block:hover{
  transform: translateY(-2px);
  box-shadow: 0 4px 14px rgba(0,0,0,0.35);
}

.dj-artist{
  font-size:15px;
  line-height:1.1;
}

.dj-time{
  font-size:12px;
  opacity:.85;
  font-weight:800;
}

.dj-block.selected{
  border: 3px solid rgba(255,255,255,0.95);
  box-shadow: 0 0 12px rgba(255,255,255,0.35);
}

.dj-block .checkmark{
  position:absolute;
  top:10px; right:12px;
  width:26px; height:26px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:16px;
  background: rgba(255,255,255,0.18);
  border:1px solid rgba(255,255,255,0.35);
  backdrop-filter: blur(6px);
}

/* =====================
   RESPONSIVE
   ===================== */
@media (max-width: 900px){
  body{ margin: 10px; }
  :root{ --col-stage: 140px; --row-h: 78px; }
  .stage-label{ font-size:14px; padding-left:10px; }
  .header{ font-size:13px; }
  .dj-artist{ font-size:13px; }
  .dj-time{ font-size:11px; }
  
  /* Permitir scroll vertical en mobile si no entra todo */
  #timetableOuter{
    max-height: calc(100vh - 120px);
    overflow-y: auto;
  }
  
  #scrollArea{
    overflow-y: visible;
  }
}

/* =====================
   BADGE DE USUARIO (topbar)
   ===================== */
#userBadge{
  display:flex;
  align-items:center;
  gap:8px;
  background: var(--panel2);
  border:1px solid var(--border2);
  padding:6px 12px;
  border-radius:10px;
  font-weight:700;
  font-size:14px;
}

.user-dot{
  width:14px; height:14px;
  border-radius:50%;
  flex-shrink:0;
  box-shadow: 0 0 6px currentColor;
}

.user-name{ color: var(--text); }

.user-change{
  background:none; border:none; cursor:pointer;
  font-size:14px; padding:0; line-height:1;
  opacity:.7; transition:.2s;
}
.user-change:hover{ opacity:1; transform:scale(1.2); }

/* =====================
   ATENUADO PARCIAL — dos capas:
   - dim-overlay-row: en la fila, cubre los gaps arriba/abajo del bloque
   - dim-overlay: dentro del bloque, recortado por overflow:hidden + border-radius
   ===================== */
.dim-overlay-row{
  position:absolute;
  top:0; bottom:0;
  background: rgba(0,0,0,0.82);
  pointer-events:none;
  z-index:19;             /* debajo de los bloques (z:20), solo tapa el gap */
}

.dim-overlay{
  position:absolute;
  top:0; bottom:0;
  border-radius:0;
  background: rgba(0,0,0,0.82);
  pointer-events:none;
  z-index:25;
}

/* =====================
   SEGMENTO DE ITINERARIO (franja encima del bloque)
   ===================== */
.itinerary-seg{
  position:absolute;
  top:0; bottom:0;
  border-radius:10px;
  opacity:.92;
  pointer-events:none;
  z-index:30;
  box-shadow: 0 0 12px rgba(0,0,0,0.5);
  /* borde más oscuro del mismo color — se aplica via JS */
  border:3px solid var(--seg-border-color, rgba(0,0,0,0.35));
}

/* Texto del artista sobre la franja */
.itinerary-seg-label{
  position:absolute;
  top:50%;
  left:8px; right:8px;
  transform:translateY(-50%);
  display:flex;
  flex-direction:column;
  gap:2px;
  pointer-events:none;
  overflow:hidden;
}

.seg-lbl-artist{
  font-size:12px;
  font-weight:900;
  color:rgba(0,0,0,0.82);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  line-height:1.2;
}

.seg-lbl-time{
  font-size:10px;
  font-weight:700;
  color:rgba(0,0,0,0.6);
  white-space:nowrap;
  line-height:1.2;
}

/* =====================
   MODAL — elegir color (pantalla de bienvenida)
   ===================== */
#colorPickerOverlay{
  position:fixed; inset:0;
  background: rgba(0,0,0,.85);
  backdrop-filter: blur(8px);
  z-index:9000;
  display:flex;
  align-items:center;
  justify-content:center;
}

.cp-modal{
  background: var(--panel2);
  border:1px solid var(--border2);
  border-radius:20px;
  padding:36px 40px;
  max-width:480px; width:90%;
  text-align:center;
}

.cp-logo{ font-size:48px; margin-bottom:8px; }

.cp-modal h2{
  font-size:22px; font-weight:900;
  margin:0 0 4px;
  background: linear-gradient(135deg,#ff4da6,#7b3cff);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}

.cp-sub{
  color:var(--muted); font-size:14px; margin:16px 0 8px;
}

.cp-modal input{
  width:100%; padding:12px 16px;
  background:rgba(255,255,255,0.06);
  border:1px solid var(--border2);
  border-radius:10px; color:white;
  font-size:16px; font-weight:700;
  outline:none; text-align:center;
  transition:.2s;
}
.cp-modal input:focus{ border-color: var(--accent); }

.cp-colors{
  display:grid;
  grid-template-columns: repeat(4,1fr);
  gap:10px;
  margin:12px 0;
}

.cp-color-btn{
  display:flex; flex-direction:column;
  align-items:center; gap:6px;
  background: rgba(255,255,255,0.04);
  border:2px solid transparent;
  border-radius:12px; padding:10px 4px;
  cursor:pointer; transition:.2s;
  color:var(--muted); font-size:11px; font-weight:700;
}

.cp-swatch{
  width:32px; height:32px; border-radius:50%;
  background: var(--c);
  box-shadow: 0 0 8px var(--c);
}

.cp-color-btn:hover{ background:rgba(255,255,255,0.08); border-color:var(--c); }
.cp-color-btn.active{
  border-color:white;
  background:rgba(255,255,255,0.12);
  box-shadow:0 0 12px var(--c);
}

.cp-preview{
  font-size:14px; font-weight:700;
  min-height:20px; margin:8px 0 16px;
  opacity:.9;
}

.cp-confirm{
  width:100%; padding:14px;
  background: var(--accent);
  border:none; border-radius:12px;
  color:white; font-size:16px; font-weight:900;
  cursor:pointer; transition:.2s;
}
.cp-confirm:not(:disabled):hover{ filter:brightness(1.15); transform:translateY(-1px); }
.cp-confirm:disabled{ opacity:.35; cursor:not-allowed; }

/* =====================
   POPUP — selección de tramo (15 min)
   ===================== */
#segPickerOverlay{
  position:fixed; inset:0;
  background:rgba(0,0,0,.7);
  backdrop-filter:blur(6px);
  z-index:8000;
  display:flex;
  align-items:center;
  justify-content:center;
}

.seg-modal{
  background:var(--panel2);
  border:1px solid var(--border2);
  border-radius:20px;
  padding:28px 28px 24px;
  max-width:440px; width:92%;
  position:relative;
}

.seg-close{
  position:absolute; top:14px; right:16px;
  background:none; border:none; color:var(--muted);
  font-size:20px; cursor:pointer; transition:.2s;
}
.seg-close:hover{ color:white; transform:scale(1.2); }

.seg-header{ margin-bottom:12px; }

.seg-title{
  font-size:20px; font-weight:900;
  color:white; line-height:1.2;
}

.seg-subtitle{
  font-size:13px; color:var(--muted); margin-top:4px;
}

.seg-instructions{
  font-size:13px; color:var(--muted);
  margin:0 0 14px; line-height:1.5;
}

.seg-slots{
  display:grid;
  grid-template-columns: repeat(4,1fr);
  gap:8px;
  margin-bottom:12px;
  user-select:none;
}

.seg-slot{
  background:rgba(255,255,255,0.06);
  border:2px solid rgba(255,255,255,0.12);
  border-radius:10px;
  padding:10px 4px;
  text-align:center;
  cursor:pointer;
  transition:.15s;
  font-size:12px; font-weight:700;
  color:var(--muted);
}

.seg-slot:hover{
  background:rgba(255,255,255,0.12);
  border-color: var(--user-color);
}

.seg-slot.active{
  background: var(--user-color);
  border-color: var(--user-color);
  color:#000;
  box-shadow: 0 0 10px var(--user-color);
}

/* Slot bloqueado por otro escenario */
.seg-slot.blocked{
  background: rgba(255,255,255,0.04);
  border-color: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.2);
  cursor: not-allowed;
  position:relative;
}

.seg-slot-lock{
  display:block;
  font-size:10px;
  color:rgba(255,255,255,0.25);
  margin-top:2px;
  pointer-events:none;
}

.seg-slot-time{ pointer-events:none; }

.seg-summary{
  font-size:13px; font-weight:700;
  text-align:center; min-height:18px;
  margin-bottom:14px; color:var(--muted);
}

.seg-actions{
  display:flex; gap:10px;
}

.seg-btn{
  flex:1; padding:12px;
  border-radius:10px; border:none;
  font-size:14px; font-weight:800;
  cursor:pointer; transition:.2s;
}

.seg-clear{
  background:rgba(255,255,255,0.07);
  color:var(--muted);
}
.seg-clear:hover{ background:rgba(255,255,255,0.12); color:white; }

.seg-save{
  background: var(--user-color);
  color:#000;
}
.seg-save:hover{ filter:brightness(1.12); transform:translateY(-1px); }

/* ── Range slider (reemplaza slots de 15min) ── */
.range-wrap{
  position:relative;
  height:60px;
  margin:8px 14px 4px;
  user-select:none;
}

.range-track{
  position:absolute;
  top:50%; left:0; right:0;
  height:6px;
  transform:translateY(-50%);
  background:rgba(255,255,255,0.12);
  border-radius:4px;
}

.range-fill{
  position:absolute;
  top:50%; height:8px;
  transform:translateY(-50%);
  border-radius:4px;
  opacity:.85;
  pointer-events:none;
}

.range-handle{
  position:absolute;
  top:50%;
  transform:translate(-50%,-50%);
  width:32px; height:32px;
  cursor:grab;
  z-index:10;
  display:flex; align-items:center; justify-content:center;
  touch-action:none;
}
.range-handle:active{ cursor:grabbing; }

.range-handle-inner{
  width:22px; height:22px;
  border-radius:50%;
  background:white;
  border:3px solid var(--bg);
  box-shadow:0 0 0 2px white, 0 2px 8px rgba(0,0,0,.6);
  transition:transform .1s;
}
.range-handle:active .range-handle-inner,
.range-handle.dragging .range-handle-inner{ transform:scale(1.25); }

.range-label{
  position:absolute;
  bottom:2px;
  font-size:10px; font-weight:700;
  color:var(--muted); opacity:.65;
  pointer-events:none;
}
.range-label-start{ left:0; }
.range-label-end  { right:0; }

.range-blocked-layer{
  position:absolute;
  top:50%; left:0; right:0;
  height:6px;
  transform:translateY(-50%);
  pointer-events:none;
  z-index:2;
}

.range-blocked{
  position:absolute;
  top:-2px; bottom:-2px;
  background:rgba(255,60,60,0.5);
  border-radius:3px;
}

.range-summary{
  text-align:center;
  font-size:18px; font-weight:900;
  margin:12px 0 16px;
  min-height:24px;
  letter-spacing:.5px;
}

/* =====================
   BOTONES MÚSICA (YouTube / Spotify)
   ===================== */
.seg-music-btns{
  display:flex;
  gap:8px;
  margin-top:10px;
}

.music-btn{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:7px 14px;
  border-radius:20px;
  font-size:12px;
  font-weight:800;
  text-decoration:none;
  transition: transform .15s, filter .15s;
  flex:1;
  justify-content:center;
}

.music-btn:hover{
  transform:translateY(-2px);
  filter:brightness(1.15);
}

.music-btn svg{
  width:15px; height:15px;
  flex-shrink:0;
}

.music-btn.yt{
  background:#FF0000;
  color:white;
}

.music-btn.sp{
  background:#1DB954;
  color:white;
}

/* =====================
   SELECTOR DE USUARIOS
   ===================== */
#userSelector{
  display:flex;
  flex-direction:column;
  gap:8px;
}

#userSelector label{
  font-size:12px;
  font-weight:700;
  color:var(--muted);
  margin-bottom:4px;
}

#userCheckboxes{
  display:flex;
  flex-direction:column;
  gap:6px;
}

.user-checkbox{
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  background:rgba(255,255,255,0.05);
  border-radius:8px;
  cursor:pointer;
  transition:.15s;
  font-size:13px;
}

.user-checkbox:hover{
  background:rgba(255,255,255,0.1);
}

.user-checkbox input[type="checkbox"]{
  cursor:pointer;
}

.seg-lbl-user{
  font-size:9px;
  font-weight:600;
  color:rgba(0,0,0,0.5);
  margin-top:1px;
}

@media (max-width: 900px){
  #userSelector{
    font-size:11px;
  }
  .user-checkbox{
    font-size:12px;
    padding:5px 8px;
  }
}


